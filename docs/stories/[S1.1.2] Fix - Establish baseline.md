

2. Windsurf / Codex prompt: implement baseline adapter + execute

Below is the final, execution-ready, SINGLE-FILE PROMPT.

This prompt assumes:
	•	baseline files are restored and untouched
	•	seam analysis above is correct and authoritative
	•	Codex GPT-5.2 (high reasoning) is being used

Paste this verbatim into Windsurf.

⸻

WINDSURF TASK — IMPLEMENT BASELINE VIA CONFIRMED SEAM AND EXECUTE

CRITICAL IMMUTABILITY RULE (NON-NEGOTIABLE)
You may NOT modify, refactor, reformat, or edit any of the following files:
	•	baseline/structural.py
	•	baseline/kapman_v0_handwritten_structural.py

These are immutable research artifacts.

All Fast Bench integration must occur outside these files.

⸻

Objective
Implement the handwritten Wyckoff baseline in wyckoff_fast_bench using the confirmed algorithm seam, and execute it symbol-by-symbol.

The baseline must:
	•	call the true algorithm entry point
	•	preserve behavior byte-for-byte
	•	emit sparse events for benchmarking

⸻

Confirmed Algorithm Seam (AUTHORITATIVE)
	•	Call: structural.detect_structural_wyckoff(df, cfg=None)
	•	Read from: result["events"]
	•	Each event dict contains: date, label, score

Do NOT use:
	•	KapmanV0HandwrittenStructural
	•	EventCode, WyckoffSignal, ScoreName
	•	any old harness logic

⸻

Step 1 — Create Adapter (NEW FILE ONLY)
Create:

baseline/adapter.py

This file must:
	1.	Import baseline.structural
	2.	Define a function, e.g. run_baseline_structural(df, symbol, cfg=None)
	3.	Call:

result = structural.detect_structural_wyckoff(df, cfg)


	4.	Extract result["events"]
	5.	Return a pandas DataFrame with columns:
	•	symbol (from argument)
	•	date (event[“date”])
	•	event (event[“label”])
	•	score (event[“score”])

No normalization, no clamping, no reinterpretation.

⸻

Step 2 — Wire Adapter into Fast Bench
In detectors.py:
	•	Import the adapter
	•	Define:

baseline_detector(df, cfg)


	•	Extract symbol from df or caller context
	•	Call the adapter
	•	Return the resulting events DataFrame

No logic beyond delegation.

⸻

Step 3 — Minimal Execution Check
In run.py:
	•	For the first symbol only:
	•	Run baseline_detector
	•	Print:
	•	event count
	•	unique event names
	•	min/max event date

Then proceed with normal execution.

⸻

Forbidden Actions (Restated)
You may NOT:
	•	Modify baseline files
	•	Import or recreate old harness contracts
	•	Normalize scores
	•	Add sequencing logic
	•	Add phase interpretation

This task is baseline measurement only.

⸻

Acceptance Criteria
The task is complete when:
	•	Baseline files remain unchanged
	•	Fast Bench calls detect_structural_wyckoff directly
	•	Events are emitted with correct labels/dates/scores
	•	Full-universe execution is possible
	•	No old harness code is involved

⸻

End of Task
Implement the adapter, wire it in, execute the baseline, and stop.

⸻
